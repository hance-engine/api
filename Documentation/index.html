<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HANCE Model Inference Library: HANCE API – C Interface</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HANCE Model Inference Library<span id="projectnumber">&#160;1.0.3</span>
   </div>
   <div id="projectbrief">C Interface for the HANCE Neural Network Model Inference Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">HANCE API – C Interface </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >The C interface for the HANCE Audio Engine provides developers with simple access to HANCE's powerful algorithms and processing capabilities from all languages that offer bindings for standard C compatible libraries. The HANCE Audio Engine is a light-weight and cross-platform library, and it should be very easy to integrate it into your application. The library can load pre-trained AI models and use these for audio processing to perform various tasks such as noise reduction and de-reverberation.</p>
<p >The HANCE Audio Engine is delivered with general purpose models for noise reduction and de-reverberation. These are designed to meet common requirements in terms of latency and CPU usage. However, we can train custom models for lower latencies or less CPU usage at the cost of separation quality. Please <a href="https://hance.ai/contact">contact us</a> for more information.</p>
<h1><a class="anchor" id="intro_sec"></a>
Getting Started</h1>
<p >The HANCE API is designed to be as simple as possible. The <b>ProcessFile</b> example (see the <b>Examples</b> folder in the API) illustrates how to create a HANCE processor and process audio with it. <a href="https://cmake.org/">CMake 3.0</a> or later is required to build the example. To build <b>ProcessFile</b>, open the terminal / command line prompt and locate the Examples/ProcessFile subfolder in the HANCE API. Now, please type "./Build.sh" on Mac or Linux, or "Build.bat" on Windows.</p>
<p >To use the HANCE API, we first need to make sure the "Include" in the HANCE API is added to the header search path and include the HanceEngine header file: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_hance_engine_8h.html">HanceEngine.h</a>&quot;</span></div>
<div class="ttc" id="a_hance_engine_8h_html"><div class="ttname"><a href="_hance_engine_8h.html">HanceEngine.h</a></div></div>
</div><!-- fragment --><p> Now we can create an instance of a HANCE processor by specifying a path to a HANCE model file along with the number of channels and sample rate to use: </p><div class="fragment"><div class="line"><span class="comment">// Create a HANCE processor that loads the pre-trained model from file</span></div>
<div class="line">processorHandle = <a class="code hl_function" href="_hance_engine_8h.html#a66a537c952ed493d7420cfeac11a02f4">hanceCreateProcessor</a> (modelFilePath, numOfChannels, sampleRate);</div>
<div class="line"><span class="keywordflow">if</span> (processorHandle == <span class="keyword">nullptr</span>)</div>
<div class="line">    handleError (<span class="stringliteral">&quot;Unable to create the HANCE audio processor.&quot;</span>);</div>
<div class="ttc" id="a_hance_engine_8h_html_a66a537c952ed493d7420cfeac11a02f4"><div class="ttname"><a href="_hance_engine_8h.html#a66a537c952ed493d7420cfeac11a02f4">hanceCreateProcessor</a></div><div class="ttdeci">HANCE_API HanceProcessorHandle hanceCreateProcessor(const char *modelFilepath, int32_t numOfChannels, double sampleRate)</div></div>
</div><!-- fragment --><p> The processor handle will be nullptr if the processor couldn't be created, e.g., because the model file path is invalid.</p>
<p >Now, we can add audio in floating point format to the HANCE processor. The HANCE API supports audio stored either as channel interleaved audio (hanceAddAudioInterleaved and hanceGetAudioInterleaved) or as separate channel vectors (hanceAddAudio and hanceGetAudio). We demonstrate how to add audio from a std::vector containing channel interleaved float values below:</p>
<div class="fragment"><div class="line"><span class="comment">// We read PCM audio from the file in the 32-bit floating point format</span></div>
<div class="line"><a class="code hl_function" href="_hance_engine_8h.html#a47327e05a3bd587ec69a036e5f433701">hanceAddAudioInterleaved</a> (processorHandle, audioBuffer.data(),</div>
<div class="line">                          audioBuffer.size() / numOfChannels);</div>
<div class="ttc" id="a_hance_engine_8h_html_a47327e05a3bd587ec69a036e5f433701"><div class="ttname"><a href="_hance_engine_8h.html#a47327e05a3bd587ec69a036e5f433701">hanceAddAudioInterleaved</a></div><div class="ttdeci">HANCE_API void hanceAddAudioInterleaved(HanceProcessorHandle processorHandle, const float *interleavedPCM, int32_t numOfSamples)</div></div>
</div><!-- fragment --><p >The processing introduces latencies, so we need to query how many samples (if any) that are available before we can pick up the processed audio using hanceGetAudioInterleaved:</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> numOfPendingSamples = <a class="code hl_function" href="_hance_engine_8h.html#a60d94cd376ed82bbb62068bff96998fa">hanceGetNumOfPendingSamples</a> (processorHandle);</div>
<div class="line">vector&lt;float&gt; processedBuffer (numOfChannels * numOfPendingSamples);</div>
<div class="line"><span class="keywordflow">if</span> (!<a class="code hl_function" href="_hance_engine_8h.html#afb4fc749ef865dc75f9678526a2fccd8">hanceGetAudioInterleaved</a> (processorHandle,</div>
<div class="line">                               processedBuffer.data(),</div>
<div class="line">                               numOfPendingSamples))</div>
<div class="line">{</div>
<div class="line">    handleError (<span class="stringliteral">&quot;Unable to get audio from the HANCE audio processor.&quot;</span>);</div>
<div class="line">}</div>
<div class="ttc" id="a_hance_engine_8h_html_a60d94cd376ed82bbb62068bff96998fa"><div class="ttname"><a href="_hance_engine_8h.html#a60d94cd376ed82bbb62068bff96998fa">hanceGetNumOfPendingSamples</a></div><div class="ttdeci">HANCE_API int32_t hanceGetNumOfPendingSamples(HanceProcessorHandle processorHandle)</div></div>
<div class="ttc" id="a_hance_engine_8h_html_afb4fc749ef865dc75f9678526a2fccd8"><div class="ttname"><a href="_hance_engine_8h.html#afb4fc749ef865dc75f9678526a2fccd8">hanceGetAudioInterleaved</a></div><div class="ttdeci">HANCE_API bool hanceGetAudioInterleaved(HanceProcessorHandle processorHandle, float *interleavedPCM, int32_t numOfSamples)</div></div>
</div><!-- fragment --><p >You can add silent audio (all values set to zero) to get the processing tail caused by the model's latency. When you have completed the processing of the audio stream, please make sure to delete the HANCE processor to free its memory: </p><div class="fragment"><div class="line"><a class="code hl_function" href="_hance_engine_8h.html#a392bbe2587d859e1551c54aba9b7f905">hanceDeleteProcessor</a> (processorHandle);</div>
<div class="ttc" id="a_hance_engine_8h_html_a392bbe2587d859e1551c54aba9b7f905"><div class="ttname"><a href="_hance_engine_8h.html#a392bbe2587d859e1551c54aba9b7f905">hanceDeleteProcessor</a></div><div class="ttdeci">HANCE_API void hanceDeleteProcessor(HanceProcessorHandle processorHandle)</div></div>
</div><!-- fragment --><h1><a class="anchor" id="Performance"></a>
Considerations</h1>
<p >The HANCE Audio Engine is a light-weight and cross-platform library, and it uses either of the following libraries for vector arithmetic if available:</p><ul>
<li>Intel Performance Primitives</li>
<li>Apple vDSP</li>
</ul>
<p >The HANCE Audio Engine reverts to pure C++ when no compatible vector arithmetic library is available.</p>
<p >Copyright (c) 2023 HANCE AS. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
